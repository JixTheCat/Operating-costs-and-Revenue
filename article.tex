
\documentclass[review,12pt,authoryear]{elsarticle}

\let\today\relax
\makeatletter
\def\ps@pprintTitle{%
    \let\@oddhead\@empty
    \let\@evenhead\@empty
    \def\@oddfoot{\footnotesize\itshape
         {Submitted preprint to Journal of Agricultural and Food Research} \hfill\today}%
    \let\@evenfoot\@oddfoot
    }
\makeatother

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
\usepackage{lineno}

% for adjusting table width automatically
\usepackage{adjustbox}
\usepackage{tabulary, ragged2e}
\usepackage{booktabs}
\usepackage{longtable}

\begin{document}
\begin{linenumbers}
\begin{frontmatter}

\title{An analysis of underlying relationships between factors related to operating costs and revenue in Australian vineyards.}

\begin{abstract}

Through a nationwide data set, collected over ten years, we link key variables in determining vineyard operational costs and revenue through the use of XGBoost. We further use a measure of relative importance to show the interrelated nature of these variables and the comparative influence they have on one another. Connections between variables is presented through the use of Sankey and Chord diagrams to show the important predictors of revenue and operating costs and their strong interrelatedness. Furthermore, we connect these variables to different wine regions, highlighting the complex influence of location on the use of different resources. With the Australian wine industry being a major contributor to Australia's agricultural sector and economy, this study provides valuable insights into the multifaceted dynamics governing operational costs and revenue, illustrating how factors such as water and fuel use impact operational costs and how different seasonal events affect these operations. 

\end{abstract}

\end{frontmatter}

\section{Introduction}

Strong demands for Australian wine have historically helped to create a thriving industry. However, recent pressures brought on by a loss of tourism and labour due to the COVID-19 pandemic, the global freight crisis, war in Europe, tariffs and rising inflation have negatively affected the industry's outlook \citep{wineaustraliaNationalVintageReport2021,australiaAustralianWineProduction2021}. The 2021-2022 financial year alone saw a decline of 19\% in exports solely due to tariffs \citep{wineaustraliaNationalVintageReport2022}. A greater understanding of the different underlying conditions leading to improved performance in agricultural productivity and sustainability at scale is key to making data-informed decisions to increase a nation's agricultural sustainability \citep{oecdInnovationProductivitySustainability2019}. Specifically within the Australian wine and vine industry, there is a need to further understand the driving relationships between resource use and economic output, which can help to determine more cost effective, efficient methods, and to develop benchmarks with local growers \citep{lukemanciniUnderstandingAustralianWine2020}.
\par
The potential for new insights into the driving economic forces of the Australian wine industry have manifested in an unprecedented amount of data regarding Australian winegrowing, collected through the Sustainable Winegrowing Australia program. A major part of the insights within this dataset come from the incorporation of operating costs and grape revenue, with environmental and sustainable data. We seek to address both the predictability of operating costs and revenue within the Australian winegrowing context and examine their major driving factors to observe linked trends in sustainable practices. As part of this we examine the data to study economic outcomes and their statistical relationships to vineyards' utilisation of resources. We adopt a popular, relatively new machine learning technique, XGBoost, for this analysis because it is able to overcome multicollinearity as well as highlight the level of importance that predictor variables have on response variables \citep{chenXGBoostScalableTree2016}.
\par
This study is further driven by recent reviews calling for data-driven studies to show the economic benefits of sustainable practices within the wine industry, specifically winegrowing. While there is evidence to suggest that environmentally sustainable practices can reduce costs, increase efficiency, and improve the quality of grapes, more research is needed to numerically demonstrate these benefits across different regions and climates \citep{baianoOverviewSustainabilityWine2021,marianiSustainableWinegrowingCurrent2015,montalvo-falconSustainabilityResearchWine2023, laurentReviewIssuesMethods2021}. Furthermore, many different sustainable approaches exist but are often studied in isolation or are limited in their geographical and climatic conditions, restricting their generalisability. We embrace the variation that exists between vineyards and their unique challenges across Australia. Where, vineyard decisions on-the-ground are governed by complex physical forces of a regions' resources, climate, soil and geology, as well as by external pressures such as international market demands, disease and natural disasters \citep{abadCoverCropsViticulture2021,cortezUsingDataMining2009,goodwinijeriepRegulatedDeficitIrrigation1992,hallSeasonTemporalVariation2011,kasimatiPredictingGrapeSugar2022,oliverReviewSoilPhysical2013,srivastavaNonDestructiveSensingMethods2018}.

\section{Methods}

\subsection{Data}\label{Data}

Data used in this analysis were obtained from Sustainable Winegrowing Australia (SWA), Australia's national wine industry sustainability program. SWA aims to support grape growers and winemakers in demonstrating and improving their sustainability \citep{swaSustainableWingrowingAustralia2022}. Data recorded by SWA are entered voluntarily by winegrowers, manually using a web based interface. There are a total of 6049 observations were collected from 2012/2013 to 2021/2022 financial years. Variables recorded by winegrowers are optional. Each vineyard record consists of observations comprising 23 variables reflecting a vineyard's state for the given year (see Table \ref{tab:vars}). The data was restricted to vineyards that at minimum recorded vineyard size.
\par
\begin{table}[] 
\caption{Summary of variables used in the analysis. The recorded column indicate the number of values that were either greater than zero or that were not missing (see Appendix for more information).} \label{tab:vars}
 \small
  \begin{tabular}{@{}lccc@{}}
  \toprule
  \textbf{Variable} & \textbf{Units} & \textbf{Number of Classes} & \textbf{No. Records} \\ \midrule
  Water Used & Mega Litres &  & 5846 \\
  Diesel & Litres &  & 5585 \\
  Biodiesel & Litres &  & 25 \\
  LPG & Litres &  & 958 \\
  Herbicide Spray & No. Times per year &  & 2026 \\
  Year & Class & 10 & 6049 \\
  Disease & Class & 2 & 6049 \\
  Region & Class & 58 & 6049 \\
  Solar & Kilowatt Hours &  & 622 \\
  Irrigation Type & Class & 20 & 6049 \\
  Petrol & Litres &  & 4309 \\
  Slashing & No. Times per year &  & 2290 \\
  Yield & Tonnes &  & 5935 \\
  Irrigation Energy & Class & 16 & 6049 \\
  Area Harvested & Hectares &  & 6049 \\
  Electricity & Kilowatt Hours &  & 1014 \\
  Insecticide Spray & No. Times per year &  & 1092 \\
  Fertiliser & KGs of Nitrogen &  & 795 \\
  Fungicide Spray & Times per year &  & 2260 \\
  Cover Crop & Class & 32 & 6049 \\
  Water Type/Source & Class & 39 & 6049 \\
  Grape Revenue & AUD &  & 853 \\
  Operating Costs & AUD &  & 853 \\ \bottomrule
  \end{tabular}
\end{table}
\normalsize

Due to the optional and manual recording of data, steps were taken to remove potentially erroneous entries. This process first involved discussions with SWA highlighting possible entry errors. At the end of a season any suspect entries, such as a missing fuel-use in a vineyard that recorded the use of tractors, would warrant calling individual vineyards to clarify values and logic within the data. Similarly suspicious entries within the data were first described to viticulturists for scrutiny before being addressed, either through calling growers for clarification or the removal of an observation due to its unlikely plausibility, with most cases suspected of being incorrect units (commonly litres instead of Megalitres of water used) but were not able to be verified.
\par
Due to the nature of XGBoost (eXtreme Gradient Boosting) data was not required to be scaled before used. However some transformations were done, such as multiclass variables being converted to one-hot-encoded variables (the only multiclass variables originally included were year and region). Variables relating to resource consumption, such as water-use were originally divided into whether it was river, dam, or pressurised water but were summed into total water/electricity/diesel/petrol. The source of these variables (such as river, dam, pressurised water) were then converted into binary variables that reflected the presence of a source being used. Other variables that reflected types of operations used such as irrigation-type and cover-crops were also converted to reflect whether a grower simply used these types of systems as opposed to the original format being the specific hectares covered by them. This decision due to a majority of vineyards utilising one source or a second as a backup, with an overwhelming percentage of water/electricity/irrigation prevailing within a single vineyard. The use of a binarisation also meant that importance measures would be better understood as they forced the ensemble to partition by presence or absence of a type of system as opposed to an overly specific number of hectares. This further helped to utilise relative importance for these variables directly to the act of using one system over another. This approach was compare to using the original variables but little difference in model accuracies was found between variables reported as proportion of a type used (i.e the percentage of land covered by drip irrigation), direct units of a type (i.e ML river water used) or as a binary presence/absence. Further details about these variables, their classes and their frequency is available in the Appendix.

\subsection{Additional regional data}

The variable Region represented one of the 65 Geographical Indicator Regions (GI Region) used to describe unique localised traits of vineyards across Australia \citep{hallidayAustralianWineEncyclopedia2009,oliverReviewSoilPhysical2013,soarClimateDriversRed2008}. Each region is explicitly defined under the Wine Australia Corporation Act of 1980 \citep{attorney-generalsdepartmentWineAustraliaCorporation2010}. The regional data also expanded to include summary information regarding regions' climate and terrain in the form of minimum, maximum, median and range of elevation. And, temperature and rainfall means alongside extreme heat and cold days; as well as a regions' aridity index. This data was sourced using 
\cite{remenyiAustraliasWineFuture2019} and \cite{hallSpatialAnalysisClimate2010}.

\subsection{XGBoost}

XGBoost is an ensemble method that combines multiple decision trees together to create a more accurate predictive model. The gradient boosting aspect of the ensemble is the use of a loss function to create new decision trees that add to the ensemble, improving its predictive power. The loss function is optimised iteratively to improve upon prior trees (where the loss function can be any convex function), allowing gradient descent to traverse the loss space until no substantive improvements can be made (further detail pertaining to the algorithm is described in the Appendix). Because the loss function is only required to be convex, both classification and regression can be used. Regularisation methods can also be incorporated to help prevent over fitting. This makes XGBoost incredibly versatile and accurate, whilst still being interpretable compared to other machine learning methods \citep{kistenExplainableArtificialIntelligence2024}.
\par
XGBoost analyses were conducted using the XGBoost library \citep{chenXGBoostScalableTree2016} in the Python Programming language \citep{g.vanrossumPythonTutorialTechnical1995}. It is a method that is widely used within agriculture for yield prediction \citep{d.mariadassExtremeGradientBoosting2022,liGlobalDetrendingSignificantly2024,raviCropYieldPrediction2020}, but is also highly capable method for financial predictions, even when dealing with multi-domain predictor variables \citep{ZHANG2023104045}. We utilise XGBoot due to a combination of agricultural yield prediction, financial prediction and the use of both economic and environmental variables as XGBoost is known to perform well with mixed types of predictor domains \citep{doi:10.1080/15481603.2024.2349341,ZHANG2023104045}. Furthermore we choose XGBoost as it has a good performance in predictions whilst allowing the use of directly comparable metrics to sanity check models against prior research (such as yield using $R^2$), offering insight into the relative performance of models lacking prior reference points in the literature such as revenue and operating costs and making the model more interpretable to audiences familiar with regression models \citep{heFruitYieldPrediction2022,laurentReviewIssuesMethods2021}.
\par
The ability to classify and predict continuous response variables and categoric variables alongside one another was also a consideration in the use of XGBoost, as both were contained in the data. XGBoost was also used due to its ability to handle sparse data, which was present within this dataset due to the voluntary nature of data entry, with many fields being left blank during data collection. Tree based methods also do not require data to be transformed prior to analyses; this consideration was taken into account so that specific partitions of values could be evaluated more easily and understood within original units of the data \citep{d.mariadassExtremeGradientBoosting2022}. A further consideration in its use was the level of interpretability offered through measures of 'relative importance' allowing for the ability to identify and rank variables and interactions by contribution to predictions \citep{chenXGBoostScalableTree2016}.
\par
An XGBoost model was trained for each variable so that every variable's relative importance could be calculated. This process was done three times using three iterations of data (three models for each variable). The first models were trained on the original SWA data set, the second were trained on a dataset that incorporated external data for each region and the final were trained on data with continuous variables transformed to be expressed as a ratio of vineyard area. The final dataset that consisted of ratios also included the extra regional data (but not in ratio form).

\subsection{Sankey and Chord Diagrams}

Originally created by Sankey to depict different pressures in steam engines \citep{7536189} we leverage Sankey diagrams to illustrate the different impact or 'pressure' each variable has on one another through the use of measurements of variable importance. Sankey and Chord diagrams were constructed using the Holoviews python library \citep{rudigerHolovizHoloviewsVersion2020}. Sankey diagrams (depicted on the left as section A in figures) show the top 10 contributing factors to a variables prediction using XGBoost and Chord diagrams, a circular representation of Sankey diagrams (depicted on the right as section B in figures) show how each of the top 10 factors relate to one another by measures of relative importance. Both Chord and Sankey diagrams illustrate variable importance through the size of the bands between two variables. The number at the end of a connection in the diagrams indicates a variables importance (the number of times it appeared within the ensemble).

\subsection{Variable Importance}\label{sec:importance}

XGBoost creates a large number of decision trees in the ensemble, it is hard to directly interpret the model and the derived intricate relationship between the variables. Variable importance can be measured in multiple ways, in this paper we used the frequency of a variable appearing as a node within the ensemble as a measure of its importance. This measure can be interpreted as how often a variable was the optimal choice in reducing the loss function of the ensemble. Multiclass variables are given an importance score for each individual class; for example, in the first set of analyses each specific region will have its own importance score, as will Year, Irrigation Type, etc (see Table \ref{tab:vars}).

\subsection{Validation}

The predictive accuracy of each tree was assessed through a validation process. For each model, a sample of 80\% of the data was used for training the model and the remaining 20\% was used for testing and validation. Categorical data were stratified to conserve the same proportion of class occurrences between the training, testing and validation data. The models were validated using 10 repetitions of the sampling process (10-fold cross validation). $R^2$ scores were used to determine the best regression models during validation. For analyses with continuous responses $R^2$ was used instead of RMSE to allow the comparison of models with different units to each other when considering how well each model extrapolated to further data. For binary and multiclass variables, validation was summarised through the accuracy, the proportion of true negatives and positives.

\subsection{Hyperparameters}

As part of the utilising the XGBoost model the hyperparameters of the model were tuned. The XGBoost library incorporates regularisation techniques built into the software to mitigate over-fitting and enhance model generalisation. This allowed us to utilise cross validated grid search functions when selecting for better performing hyperparameters. This method required three distinct types of metrics to be used for the three types of variables incorporated into the analysis (multiclass, binary and numeric). For consistency the metrics utilised by the grid search were aligned with the error functions used when training the model on those variables. The performance measure for model selection was root-mean-square error for continuous variables. The receiver operator characteristic's area under the curve was used for binary variables \citep{hanleyMeaningUseArea1982}. And, multiclass variables utilised the one verse one approach to minimise sensitivity to class disparity \citep{ferriExperimentalComparisonPerformance2009,handSimpleGeneralisationArea2001}.

\section{Results}

\subsection{Operating Costs}

% \begin{figure} 
%   \resizebox{\textwidth}{!}{
%   \includegraphics{operating_costs.pdf}}
%   \caption{A surrogate model decision tree predicting operating costs. Each node indicates the class predicted, and the proportion of elements agreeing with nodes partitioning, with the left direction indicating a yes to the nodes rule.}\label{fig:operating_tree}
%  \end{figure}
Compared to revenue, the predictive performance of the XGBoost model for operating cost was slightly better when not using the extra regional parameters, with an $R^2$ of 0.80 (with a standard deviation of 0.10). Similarly, when predicting without extra regional data the most important predictors of operating cost were fuel, water, area and yield (see figure \ref{fig:operating_costs_sankey}).
\par
A major difference was also in the poorer performance of the model with extra regional parameters. Although achieving a similar $R^2$ of 0.78 and a standard deviation of 0.12 the difference lay in an outlier model recording an $R^2$ of 0.08. This divergence likely being due to over generalising using elevation to match neighbouring regions. The removal of this radical leaves the inclusion of extra regional parameters outperforming the models without them, however it overlooks the major pitfall in the ease of misattributing factors and causality when predicting these variables.
\par
A surprising difference between operating cost and revenue was the change in relative importance of activities involving tractor passes where the use of fungicide was more important for operational costs, compared to revenue, where slashing was more important (see Figure \ref{fig:region_sankey}). This difference was only found when not including the extra regional parameters. The model including extra regional parameters reflected an identical hierarchy of importance to its revenue counter part (see Figures \ref{fig:operating_costs_sankey} and \ref{fig:operating_costs_sankey_extra}).
\par
The connection between spraying and operational costs is intuitive in that it utilises both the expense of equipment and resources. However, it is surprising that although spraying is considered important when extra regional parameters were not included, 'area not harvested due to disease' was not, even though disease would be a direct cause. The lack of importance on disease directly could be due to a low amount reported in the dataset (137 vineyards). The reason for spraying was also unfortunately not part of the data, and could be in response to a variety of factors such as other vineyards within the region having disease or preventative sprays. The variables that feed into these decisions are also very different with diesel having the highest relative importance to slashing, and area having the greatest relative importance to the need for fungicide.
\par
Again, Region played a determining factor overall, contributing to 334 nodes within the ensemble making it the most important variable when considering all regions together. It was surprising that electricity, slashing and spraying passes were not more prominent in operating costs due to the intrinsic nature as an agricultural expense. However, a consideration for a bias within the dataset may be explanatory towards to the lack of these factors contributing to expenses, with the dataset being derived from vineyards actively participating within a sustainability program.
\par
% . Again the surrogate model did not perform well achieving an $R^2$ of 0.0931 (with a standard deviation of 0.0197) but showed similarly to revenue an importance placed on fungicide spraying and size (see figure \ref{fig:operating_tree}).
\begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{operating_costs.png}}
  \caption{The left-hand side, A,  depicts the 10 most relative  important variables in predicting Operating Costs using XGBoost as a measure of node occurrence, using a Sankey diagram. The number at the end of each band in the diagram is that variable's importance. The right-hand side, B, depicts the importance of the 10 variables in Sankey diagram relative to one another.}\label{fig:operating_costs_sankey}
\end{figure}

\begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{operating_costs_extra.png}}
  \caption{Operational costs and variable importance with the inclusion of extra regional parameters for terrain and climate. The left-hand side, A,  depicts the 10 most relative  important variables in predicting Operating Costs using XGBoost as a measure of node occurrence, using a Sankey diagram. The number at the end of each band in the diagram is that variable's importance. The right-hand side, B, depicts the importance of the 10 variables in Sankey diagram relative to one another.}\label{fig:operating_costs_sankey_extra}
\end{figure}

\subsection{Revenue}

There was little difference in predictive power between the inclusion of climatic and regional data and the use of region alone. With the use of extra regional data achieving an $R^2$ of 0.76 (with a standard deviation of 0.13), and when not using the extra regional data achieving an $R^2$ of 0.77 (with a standard deviation of 0.15). The higher number of variables included as part of the regional data likely resulting in a lower variance in predictive power when including the extra regional data.
\par
The most notable difference was in the importance of the predictors, where elevation was a had a high relative importance of 8, only surpassed by diesel and yield, with 9 and 45 relative importance respectively (see Figure~\ref{fig:revenue_sankey_extra}). The lower variance is also reflected in the lower amount of nodes (or partitions) required when leveraging the extra regional parameters, with a reduction in hundreds of splits between the two models. Without the extra regional parameters it was found that fuel use (petrol 307 and diesel 144), yield (285), size (216) and water use (199) held the highest relative importance (see figure see Figure~\ref{fig:revenue_sankey}).
\par
Even without the extra regional parameters, overall region contributed to 234 nodes in the ensemble making it collectively the third most important variable. This places equal importance within both models on region however the nature of regions contribution is more generalised using elevation when included as a parameter. This alone does not necessarily make elevation a direct contributing factor but links regions that of similar terrain together. The relevance of this was noted when reviewing regional missclassifications, where neighbouring regions were often misclassified as each other. The extra numerical parameters that can be partitioned likely gives the algorithm a greater ability to partition these regions together using fewer nodes.

\begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{revenue.png}}
  \caption{The left-hand side depicts the 10 most important variables in predicting revenue using XGBoost as a measure of node occurrence, using a Sankey diagram. The right-hand side depicts the interrelated importance of the ten predictor variables using a chord diagram.}\label{fig:revenue_sankey}
\end{figure}

\begin{figure}[htb]
   \resizebox{\textwidth}{!}{
   \includegraphics{revenue_extra.png}}
   \caption{Revenue's variable importance with the inclusion of extra regional paramters for terrain and climate. The left-hand side, A,  depicts the 10 most relative  important variables in predicting revenue using XGBoost as a measure of node occurrence, using a Sankey diagram. The number at the end of each band in the diagram is that variable's importance. The right-hand side, B, depicts the importance of the 10 variables in Sankey diagram relative to one another.}\label{fig:revenue_sankey_extra}
\end{figure}

\subsection{Region}

Region was a highly informative variable based on measures of importance for both operating cost and revenue. As noted above, Region was the third most important variable for determining revenue. The Barossa Valley region and Tasmania were the two most important regions in relation to revenue; these two regions are considered to be some of the highest revenue per hectare regions in Australia \citep{wineaustraliaNationalVintageReport2022}. These two regions are also relative opposites in winegrowing climates with the Barossa having a warm and dry climate focussing on Shiraz grapes and Tasmania having a cool wet climate that favours Pinot/Chardonnay \citep{wineaustraliaNationalVintageReport2022}.
\par
As also noted above, Region was also a key determinant of operating costs. Tasmania had the highest relative importance, followed by the Adelaide Hills. In contrast, the regions of the highest relative importance were warmer and drier, such as the Barossa. The higher relative importance of fungicide spraying is the likely due to fungal pressure being greater in cooler wetter regions variables than in drier regions.
\par
The XGBoost ensemble for Region achieved an accuracy of 56.82\% (and 50.58\% validation accuracy). The difference in accuracy compared to the other models is in part due to the large number of classes (58 regions). The ensemble had an emphasis on area, water, fuel and yield as determining factors (see Figure (\ref{fig:region_sankey}).
\par
A number of regions had lower reporting rates, resulting in much poorer classification performance. The regions with the most samples performed the best likely due to the disparity in sample sizes. Bordering regions were routinely grouped together and misclassified as the same region. When scrutinising each class explicitly, the two areas that effected the most from this were the Limestone Coast (cool coastal areas in South Australia) and the warmer inland regions along the Murray Darling.

\begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{region.png}}
  \caption{The left-hand side, A,  depicts the 10 most relative important variables in predicting Region using XGBoost as a measure of node occurrence, using a Sankey diagram. The number at the end of each band in the diagram is that variable's importance. The right-hand side, B, depicts the importance of the 10 variables in Sankey diagram relative to one another.}\label{fig:region_sankey}
 \end{figure}

\subsection{Results per hectare}
Both operating cost and revenue were predicted as ratios of area (revenue and operating cost per vineyard hectare). In both cases it was found that the models performed poorly with operating costs recording an $R^2$ of 0.24 (with a standard deviation of 0.15) and revenue an $R^2$ of 0.32 (with a standard deviation of 0.14).

\section{Discussion}

\subsection{Region and Climate}

The relationships between vineyard resource use, operations and geographical properties is a complex one, illustrated through the highly interelated properties demonstrated in the chord diagrams. Many of the contributing physical parameters such as climate, geology and soil are predetermined by a vineyard's location, making it a widely considered key determinant of grape yield and quality \citep{abbalDecisionSupportSystem2016,agostaRegionalClimateVariability2012,fragaMultivariateClusteringViticultural2017}. The contribution of geographical properties is reflected in region's continual appearance as important variable when predicting operating costs and revenue. The significance of region to operational costs and revenue is linked to the difference in resources available between regions, well illustrated through considering the relative importance that water use had when predicting region. The difference in readily available resources between different regions is also easily demonstrated when observing the partitioning of river water as the primary source of water to identify vineyards located in the Riverland (with 456 of 472 vineyards in the Riverland utilising river water).
\par
The availability of resources and geographical features of a region are significant but are also a potentially determining factor in the types of operational decisions made, and thus the reasoning as to variation in revenue and operating costs. This can be seen in the addition of extra regional parameters that add greater context to understanding the why or cause of operating costs and revenue. The effect of different operational consideration can be reflected in higher costs incurred in regions of greater variations in slope requiring more specialised equipment, or reflected in the types of resources available in some regions. The specifics of a vineyards' site are of incredible importance when determining what causes higher operational costs or revenue, as reflected through regions significance in predicting both revenue and operational cost. Although it is useful to be able to predict and compare regions, their revenue and operational costs, a greater nuance to help understand the why behind these decisions, would help in specifically guiding operational decisions. An example of this is whether the reduction of tillage operations through optimising tractor efficiency would be useful and how to optimise tractor use for a specific operation. This example is chosen because, while this practice is undertaken to reduce energy use in vineyards, decreasing running costs, as well as reducing soil compaction \citep{capelloEffectsTractorPasses2019}. The interrelatedness of this decisions is far reaching as increase in tractor use can cause soil compaction which has been shown to further increase water runoff \citep{capelloPermanentCoverSoil2020}. With runoff itself being a significant factor during extreme rain events which can lead to large scale soil deposition, creating further erosion and removing topsoil and having wide spread effects for a vineyard. 
\par
The climatic properties of regions are also a great determiner of different practices. For instance, warmer regions are known to be beneficial in hastening the ripening process of wine grapes \citep{webbObservedTrendsWinegrape2011}. Warmer regions are also associated with lower quality grapes, caused largely due to this hastened ripening \citep{bottingCanopyArchitectureImplicationsShiraz1996}. It is likely that the combination of larger vineyards with higher water use is a determining factor in classifying regions which favour larger production of grapes; reflected through region using water use so prominently in the XGBoost ensemble. The link to water resources in defining regions is also an important consideration, as vineyards can leverage higher irrigation rates if water resources are available. A further consideration in the link between revenue and region is that grape prices are set at a regional level by buyers \citep{wineaustraliaNationalVintageReport2022}. It is also important to consider that some regions carry particular fame regarding the quality of their produce such as Tasmania, the Hunter Valley and Barossa Valley \citep{hallidayAustralianWineEncyclopedia2009}. This classification can be contrasted with other warmer regions of higher rainfall that use the warmer climate to concentrate their grapes, increasing the flavour profile \citep{goodwinijeriepRegulatedDeficitIrrigation1992,mgmccarthyEffectCropLoad1986}.

\subsection{Resource Use}

The link between arid regions and yield is also complicated through the potential restricted access to water resources. Regions are likely to have varying access to different water sources, such as those along the River Murray being able to utilise river water for crops, unlike most coastal regions which may be drawing from surface or underground water sources. Similarly, the connection between region and fuel use is likely an indicator of the level of infrastructure within the region due to vineyards in regions without pressurised water needing to use fuel or electricity to pressurise their irrigation systems. Although infrastructure between regions, especially further from cities is likely to vary, fuel price itself has little variation across regional Australia. It is reported by the Australian Competition and Consumer Commission that during the period of this data, that regional fuel prices tended to be higher (+5.4c/litre) and more stable than urban prices due to their primary driver being international market trends~\citep{aipFactsPricesRegional2019}. The importance between fuel and other variables is a complicated interaction. The size, number of blocks, types and age of equipment will contribute to the efficiency of its use and the amount required across a site. It is likely that larger operations will generally gain from economies of scale but also risk further incurring costs from the need to redeploy equipment. A further connection between region and fuel is the possible requirement of more specialist equipment, either due to regional practices differing or physical requirements such as greater inclines. However, the style of management will also greatly contribute to how efficient both fuel and water are used, which is difficult to account for through the use of a metric.

\subsection{Sustainable Practices}

Further to the consideration of including specific operations is hindered in this model due to the sample being derived specifically from vineyards already within a sustainable program. Making the sample inherently biased towards the use of sustainable practices. A keen example is the use of techniques such as cover crops. Cover crops are an example of a sustainable practice in viticulture in which the area between vine rows is seeded with a crop such as grasses or native vegetation. The primary reason for employing cover crops is to reduce the presence of disease and weeds \citep{delpuechAdaptingCoverCrop2018}. The benefit of reducing diseases and weeds is especially notable, as there is less cause to utilise heavy machinery for spraying herbicides and fungicides, or for mechanical weeding \citep{capelloEffectsTractorPasses2019}. The presence of a cover crop can also help to increase soil water retention, reducing erosion and water runoff in shallow soils, having been shown to mitigate runoff during rain events by over 65\% \citep{capelloPermanentCoverSoil2020}. However, cover crops can introduce competition with grapevines and may reduce yield depending upon the plants used and the density of the cover crop \citep{capelloEffectsTractorPasses2019,delpuechAdaptingCoverCrop2018,goslingLongTermChangesSoil2005,monteiroInfluenceCoverCrop2007}. A coverage of only 30\% is required to provide protection against erosion, yet increased cover provides the benefits of greater biodiversity at the risk of yield \citep{delpuechAdaptingCoverCrop2018}. The presence of cover crops within the sample reflects this bias, where just over 85\% (5272) of vineyards utilised some form of cover crop such as grassing and only just under 4\% (225) used only bare soil (with the remaining 552 utilising a combination). The high percentage of vineyards using this type of sustainable practice means that its effect will not be prominent within the model, and can only show what practices would further improve those already implementing these techniques, and how they are connected to these operating costs. A strength of utilising XGBoost in this context is that, a subset of particular interest can be leveraged to focus in on the combination of factors that would contribute to the specific conceived scenario. Predicting operational costs reflected this through similar importance across fuel, water and tractor use. The dominating factor of area likely played a large part in determining how costly a tractor pass would be, or in defining the ratio of water applied to the amount of vines. The relative importance was high for area but much lower in general across the other variables, which could indicate the need to be specific when attempting to determine the cause of a operational cost. Although these analyses attempted to capture the complexity between how variables interacted when determining operational costs (see Figure \ref{fig:operating_costs_sankey}), in reality these relationships are likely even more complicated. An example of how interrelated operational costs can be, is the optimisation of tractor passes to achieve multiple goals in a pass, being shown to reduce energy use in vineyards, decreasing running costs, as well as reducing soil compaction \citep{capelloEffectsTractorPasses2019}. 

\subsection{Revenue and Operational Costs}

When determining revenue, similar variables were used to operational cost; with region also being of high variable importance relative to other variables (when considering all regions together in importance). It is difficult to extrapolate the specific influence of location on a vineyard's outcomes due to the broad and varying definition of a region. Utilising the Geographical Indicator regions defined by Wine Australia \citep{australiaWineAustraliaOpenData2021} is a limitation in one way, as it is too broad to fully capture a vineyards location and how that influences variables at a more granular level. However, as buyers set prices at regional levels, it is still important to consider this factor. 
\par
Decisions made on the ground have far-reaching effects and are difficult to completely capture. A larger number of tractor passes used as a preventative measure for occurrences such as disease may incur higher operational costs but could be critical in preventing long term losses. Although the models demonstrated a good predictive fit, the ability to predict operational costs is limited by the variables incorporated in the analysis. Other factors such as erosion and soil health are also influenced by tractor use and would contribute to these operational costs but are difficult to measure and were not available as part of the data \citep{capelloEffectsTractorPasses2019,capelloPermanentCoverSoil2020}. The data collection process being voluntary and part of a sustainable program also limited the ability to compare what happened between those who had to abandon crops due to disease, pests or other catastrophes such as fire, in part due to a lack of incentive to record as part of the SWA program. Furthermore, no comparison can be made between those that have chosen to mothball as a response to predicted outcomes, or external pressures due to them not being part of the data. Although this dataset contained vineyards that suffered partial losses due to disease, these limitations offer an avenue for further study that could benefit decision processes and variable relevance regarding mothballing, crop loss and external pressures. Without fully capturing more granular activities or, for example the specific tractor operations and their differing fuel consumptions, it is difficult to determine what decisions specifically influence the operational costs. Comparisons between which varietals were planted and the differences the techniques used between them would have also greatly benefited the data. Reductions in fuel, water and tractor use are obvious methods to reduce operational costs but not necessarily achievable decisions when considering external risks such as disease.
\par
Separately, revenue and operating cost did have a greater predictability than their counterpart profit (see Appendix). The disparity in accuracy between profit and other economic outcomes is reflective of the complexity in trying to address challenges such as climate change, disease and changing market demands \citep{wineaustraliaNationalVintageReport2020,wineaustraliaNationalVintageReport2021,wineaustraliaNationalVintageReport2022}. The difference between turning a profit or loss is dependent on predictable and unpredictable factors, farming practice and farmers' decisions. The difference between vineyards that make profit and those that do not could be a multitude of factors including differences in farming practices not captured within this study.
\par
The reasoning for any particular decision can be widely varying. More sophisticated models, specifically those that utilise expert opinion, may also help to capture and address the decision-making process. An example is the optimisation of fungicide sprays using Bayesian models that forecast disease risk \citep{luDiseaseRiskForecasting2020}. Further to this the use of models such as Bayesian Networks and multi criteria decision analysis would be a useful direction to proceed in to uncover the nuanced reasons and context as to why different operational decisions are made and their direct outcomes. Further research in this direction could aid in the creation of effective decision support systems to help the Australian winegrowing industry.

\section{Conclusion}

This study has provided valuable insights into the multifaceted dynamics governing operational costs and revenue in vineyards. The impact of different regions highlighted the complex interrelatedness of variables within a vineyard. We relate how factors such as water and fuel intersect to impact operational costs and how different seasonal events affect these operations; as well as the significance of context-specific decision-making. While this investigation utilised a broad regional classification, the potential benefits of adopting a more nuanced approach and incorporating expert knowledge have been highlighted. Further work could pursue causal models and the creation of decision support systems. It is difficult to untangle the predictive and correlative nature of a variable compared to the causal reasons. By delving deeper into the complex interplay of variables, further advancements can be made in optimising vineyard management strategies for lowering operational costs, increasing revenue and enhancing sustainability.

\bibliography{references}
\bibliographystyle{elsarticle-harv}

\appendix

\section{Continuous variables}

Table \ref{tab:cont_vars} below shows the ranges of each of the continuous variables:
% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[htb]
  \caption{Summary statistics of continuous variables used in XGBoost models.}\label{tab:cont_vars}
  \resizebox{\textwidth}{!}{\begin{tabular}{@{}lllllllll@{}}
  \toprule
   & count & mean & std & min & 0.25 & 0.5 & 0.75 & max \\ \midrule
  Vineyard Solar & 622 & 22916.89 & 104808 & 1 & 1170.75 & 5500 & 14866.25 & 2300000 \\
  Biodiesel & 25 & 6635.932 & 11768.832104 & 1 & 200 & 500 & 10000 & 37216 \\
  Fungicide Spray & 2260 & 7.724801 & 3.279794 & 1 & 6 & 7 & 9 & 68 \\
  LPG & 958 & 327.831399 & 861.538804 & 1 & 40 & 95.835 & 240 & 11950 \\
  Petrol & 4309 & 825.276809 & 1556.621119 & 1 & 135 & 306.66 & 903 & 38568 \\
  Insecticide Spray & 1092 & 1.707189 & 1.316042 & 0 & 1 & 1 & 2 & 12 \\
  Water Used & 5846 & 7301838 & 558206600 & 0.0007 & 13.2655 & 43 & 146.875 & 42680000000 \\
  Fertiliser & 795 & 91149.89 & 483913.4 & 1 & 560 & 4759.5 & 45148.5 & 11358000 \\
  Diesel & 5585 & 11677.070183 & 24380.588742 & 0.1267 & 1240 & 3850 & 12500 & 591000 \\
  Yield & 5935 & 772.902449 & 2175.113895 & 0.03 & 68 & 192.3 & 601.8795 & 72305 \\
  Herbicide Spray & 2026 & 2.646199 & 2.598899 & 0 & 2 & 2 & 3 & 103 \\
  Slashing & 2290 & 3.311485 & 1.826788 & 1 & 2 & 3 & 4 & 26 \\
  Electricity & 1014 & 58223.07 & 177626.3 & 0.019 & 2160 & 9637 & 36498.25 & 3000000 \\
  Area Harvested & 6049 & 66.52604 & 133.4525 & 2.220446E-16 & 10.13 & 24.5 & 66.8 & 2436.15 \\
  Grape Revenue & 875 & 377972 & 606286.8 & 1 & 76000 & 172964 & 386747 & 5700000 \\
  Operating Costs & 853 & 314187.1 & 511522.6 & 1 & 57315 & 140000 & 327408 & 4482828 \\ \bottomrule
  \end{tabular}}
  \end{table}
\clearpage

\section{Categorical Variables}
  The tables below describe each possible class a multiclass variable could have taken and the frequency that it occured.
  \subsection{Water Source Types}
  Table \ref{tab:water_type} below shows the different class types for water sources used by vineyards and their frequency of occurrences.
  % Please add the following required packages to your document preamble:
% \usepackage{booktabs}

\begin{center}
  \begin{longtable}{p{0.5\linewidth} p{.35\linewidth}}
    \caption{Frequency and class types of water types used by vineyards.}\label{tab:water_type} \\
  
  \hline \textbf{Water types} & \textbf{frequency}\\ \hline 
  \endfirsthead
  
  \multicolumn{2}{c}%
  {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
  \hline \textbf{Water types} & \textbf{frequency} \\ \hline 
  \endhead
  
  \hline \multicolumn{2}{|r|}{{Continued on next page}} \\ \hline
  \endfoot
  
  \hline \hline
  \endlastfoot
    river water & 1578 \\
    groundwater & 1433 \\
    surface water dam & 617 \\
    recycled water from other source & 386 \\
    groundwater and surface water dam & 256 \\
    not listed & 235 \\
    mains water & 170 \\
    river water and groundwater & 147 \\
    groundwater and recycled water from other source & 145 \\
    other water & 101 \\
    river water and surface water dam & 92 \\
    groundwater and water applied for frost control & 90 \\
    groundwater and mains water & 76 \\
    river water and groundwater and  surface water dam & 70 \\
    recycled water from other source and mains water & 63 \\
    groundwater and recycled water from other source and mains water & 60 \\
    river water and mains water & 57 \\
    surface water dam and mains water & 56 \\
    groundwater and other water & 33 \\
    river water and groundwater and mains water & 30 \\
    groundwater and surface water dam and recycled water from other source & 27 \\
    river water and water applied for frost control & 27 \\
    groundwater and surface water dam and mains water & 22 \\
    surface water dam and recycled water from other source & 21 \\
    river water and recycled water from other source & 19 \\
    river water and other water & 19 \\
    river water and surface water dam and mains water & 18 \\
    river water and groundwater and surface water dam and mains water & 18 \\
    mains water and other water & 16 \\
    groundwater and surface water dam and water applied for frost control & 12 \\
    surface water dam and other water & 12 \\
    groundwater and recycled water from other source and other water & 11 \\
    groundwater and surface water dam and recycled water from other source and mains water & 8 \\
    recycled water from other source and mains water and other water & 8 \\
    river water and recycled water from other source and mains water & 8 \\
    river water and surface water dam and recycled water from other source & 8 \\
    surface water dam and mains water and other water & 7 \\
    recycled water from other source and other water & 7 \\
    river water and groundwater and recycled water from other source & 6 \\
    groundwater and mains water and other water & 5 \\
    groundwater and surface water dam and other water & 5 \\
    groundwater and surface water dam and mains water and other water & 5 \\
    river water and groundwater and recycled water from other source and mains water & 5 \\
    river water and groundwater and water applied for frost control & 5 \\
    river water and surface water dam and water applied for frost control & 4 \\
    surface water dam and water applied for frost control & 4 \\
    river water and groundwater and surface water dam and recycled water from other source and mains water and other water & 4 \\
    river water and groundwater and recycled water from other source and other water & 3 \\
    groundwater and surface water dam and recycled water from other source and water applied for frost control & 3 \\
    river water and groundwater and surface water dam and recycled water from other source & 3 \\
    river water and recycled water from other source and other water & 3 \\
    surface water dam and recycled water from other source and mains water & 2 \\
    river water and recycled water from other source and mains water and water applied for frost control & 2 \\
    groundwater and surface water dam and recycled water from other source and mains water and other water & 2 \\
    river water and groundwater and mains water and other water & 2 \\
    river water and groundwater and surface water dam and other water & 2 \\
    river water and surface water dam and other water & 2 \\
    river water and mains water and water applied for frost control & 2 \\
    river water and groundwater and surface water dam and recycled water from other source and mains water & 2 \\
    river water and mains water and other water & 2 \\
    river water and surface water dam and mains water and other water & 2 \\
    river water and groundwater and mains water and water applied for frost control & 1 \\
    surface water dam and other water and water applied for frost control & 1 \\
    water applied for frost control & 1 \\
    groundwater and other water and water applied for frost control & 1 \\
    other water and water applied for frost control & 1 \\
    groundwater and surface water dam and recycled water from other source and other water and water applied for frost control & 1 \\
    mains water and water applied for frost control & 1 \\
    groundwater and surface water dam and recycled water from other source and other water & 1 \\
    groundwater and mains water and water applied for frost control & 1 \\
    river water and groundwater and surface water dam and mains water and other water & 1 \\
    river water and surface water dam and recycled water from other source and mains water & 1 \\

  \end{longtable}
  \end{center}
  
  \clearpage
\subsection{Cover Crop Types}
Table \ref{tab:cover_crop} below shows the different cover crop types used together and their frequency.

\begin{center}
  \begin{longtable}{p{0.5\linewidth} p{.35\linewidth}}
    \caption{Frequency and class types of cover crop types used by vineyards.}\label{tab:cover_crop} \\
  
  \hline \textbf{Cover crop types} & \textbf{frequency}\\ \hline 
  \endfirsthead
  
  \multicolumn{2}{c}%
  {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
  \hline \textbf{Cover crop types} & \textbf{frequency} \\ \hline 
  \endhead
  
  \hline \multicolumn{2}{|r|}{{Continued on next page}} \\ \hline
  \endfoot
  
  \hline \hline
  \endlastfoot

  Cover crop types & frequency \\
  permanent cover crop volunteer sward & 1822 \\
  permanent cover crop non native & 936 \\
  permanent cover crop native & 490 \\
  annual cover crop & 479 \\
  groundwater and surface water dam & 406 \\
  annual cover crop and permanent cover crop volunteer sward & 309 \\
  bare soil & 225 \\
  permanent cover crop non native and permanent cover crop volunteer sward & 214 \\
  annual cover crop and permanent cover crop non native & 169 \\
  bare soil and permanent cover crop volunteer sward & 129 \\
  bare soil and permanent cover crop non native & 115 \\
  annual cover crop and permanent cover crop non native and permanent cover crop volunteer sward & 101 \\
  bare soil and annual cover crop & 93 \\
  permanent cover crop native and permanent cover crop volunteer sward & 80 \\
  bare soil and permanent cover crop native & 78 \\
  annual cover crop and permanent cover crop native & 78 \\
  permanent cover crop native and permanent cover crop non native & 68 \\
  permanent cover crop native and permanent cover crop non native and permanent cover crop volunteer sward & 44 \\
  annual cover crop and permanent cover crop native and permanent cover crop non native and permanent cover crop volunteer sward & 44 \\
  bare soil and annual cover crop and permanent cover crop volunteer sward & 33 \\
  bare soil and permanent cover crop non native and permanent cover crop volunteer sward & 26 \\
  annual cover crop and permanent cover crop native and permanent cover crop volunteer sward & 17 \\
  bare soil and annual cover crop and permanent cover crop native & 15 \\
  annual cover crop and permanent cover crop native and permanent cover crop non native & 15 \\
  bare soil and annual cover crop and permanent cover crop non native & 13 \\
  bare soil and annual cover crop and permanent cover crop native and permanent cover crop non native and permanent cover crop volunteer sward & 12 \\
  bare soil and annual cover crop and permanent cover crop non native and permanent cover crop volunteer sward & 11 \\
  bare soil and annual cover crop and permanent cover crop native and permanent cover crop non native & 8 \\
  bare soil and permanent cover crop native and permanent cover crop non native & 7 \\
  bare soil and permanent cover crop native and permanent cover crop volunteer sward & 6 \\
  bare soil and permanent cover crop native and permanent cover crop non native and permanent cover crop volunteer sward & 4 \\
  bare soil and annual cover crop and permanent cover crop native and permanent cover crop volunteer sward and & 2 \\
  \end{longtable}
  \end{center}
  \clearpage


\subsection{Irrigation Types}
Below in Table \ref{tab:irig_types} are the frequency and different irrigation types.

\begin{center}
  \begin{longtable}{p{0.5\linewidth} p{.35\linewidth}}
    \caption{Frequency and class types of irrigation types used by vineyards.}\label{tab:irig_types} \\
  
  \hline \textbf{Irrigation types} & \textbf{frequency}\\ \hline 
  \endfirsthead
  
  \multicolumn{2}{c}%
  {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
  \hline \textbf{Irrigation types} & \textbf{frequency} \\ \hline 
  \endhead
  
  \hline \multicolumn{2}{|r|}{{Continued on next page}} \\ \hline
  \endfoot
  
  \hline \hline
  \endlastfoot
  Irrigation type & frequency \\
  dripper & 4800 \\
  dripper and non irrigated & 342 \\
  Not listed & 319 \\
  dripper and overhead sprinkler & 201 \\
  dripper and undervine sprinkler & 91 \\
  non irrigated & 65 \\
  undervine sprinkler & 53 \\
  dripper and flood & 53 \\
  overhead sprinkler & 46 \\
  dripper and overhead sprinkler and undervine sprinkler & 28 \\
  overhead sprinkler and undervine sprinkler & 12 \\
  dripper and non irrigated and overhead sprinkler & 11 \\
  flood and undervine sprinkler & 10 \\
  dripper and flood and undervine sprinkler & 7 \\
  dripper and flood and non irrigated and overhead sprinkler and undervine sprinkler & 3 \\
  dripper and flood and overhead sprinkler & 3 \\
  non irrigated and undervine sprinkler & 2 \\
  dripper and flood and non irrigated & 1 \\
  dripper and non irrigated and overhead sprinkler and undervine sprinkler & 1 \\
  flood and & 1 \\
\end{longtable}
\end{center}

  \clearpage

  \subsection{Irrigation Energy Type}
Below, Table \ref{tab:irig_energy} shows the different types of energy used to power vineyards and their frequency.

\begin{center}
  \begin{longtable}{p{0.5\linewidth} p{.35\linewidth}}
    \caption{Frequency and class types of irrigation energy types used by vineyards.}\label{tab:irig_energy}  \\
  
  \hline \textbf{Irrigation Energy types} & \textbf{frequency}\\ \hline 
  \endfirsthead
  
  \multicolumn{2}{c}%
  {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
  \hline \textbf{Irrigation Energy types} & \textbf{frequency} \\ \hline 
  \endhead
  
  \hline \multicolumn{2}{|r|}{{Continued on next page}} \\ \hline
  \endfoot
  
  \hline \hline
  \endlastfoot

  Irrigation energy type & frequency \\
  electricity & 2162 \\
  not listed & 2053 \\
  pressure & 586 \\
  electricity and pressure & 396 \\
  diesel & 254 \\
  diesel and electricity & 227 \\
  electricity and solar & 96 \\
  diesel and electricity and pressure & 90 \\
  diesel and pressure & 74 \\
  solar & 50 \\
  electricity and pressure and solar & 23 \\
  diesel and electricity and solar & 14 \\
  diesel and electricity and pressure and solar & 10 \\
  pressure and solar & 9 \\
  diesel and solar & 4 \\
  diesel and pressure and solar and & 1 \\ \bottomrule
\end{longtable}
\end{center}

  \clearpage

  \subsection{Year}
Below in Table \ref{tab:year} is the list of years and the number of sample collected in each.

    \begin{center}
      \begin{longtable}{p{0.5\linewidth} p{.35\linewidth}}
        \caption{Frequency and class types of year}\label{tab:year}  \\
      
      \hline \textbf{Year } & \textbf{frequency}\\ \hline 
      \endfirsthead
      
      \multicolumn{2}{c}%
      {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
      \hline \textbf{Year} & \textbf{frequency} \\ \hline 
      \endhead
      
      \hline \multicolumn{2}{|r|}{{Continued on next page}} \\ \hline
      \endfoot
      
      \hline \hline
      \endlastfoot
    
  Year & frequency \\
  2021/2022 & 954 \\
  2020/2021 & 860 \\
  2019/2020 & 599 \\
  2012/2013 & 590 \\
  2013/2014 & 549 \\
  2015/2016 & 548 \\
  2014/2015 & 505 \\
  2017/2018 & 493 \\
  2016/2017 & 485 \\
  2018/2019 & 466 \\

\end{longtable}
\end{center}

\clearpage

\subsection{Region}
Below in Table \ref{tab:region} are the number of collected samples for each region.
\begin{center}
  \begin{longtable}{p{0.5\linewidth} p{.35\linewidth}}
    \caption{Frequency and class types of regions.}\label{tab:region}  \\
  
  \hline \textbf{Regions} & \textbf{frequency}\\ \hline 
  \endfirsthead
  
  \multicolumn{2}{c}%
  {{\bfseries \tablename\ \thetable{} -- continued from previous page}} \\
  \hline \textbf{Regions} & \textbf{frequency} \\ \hline 
  \endhead
  
  \hline \multicolumn{2}{|r|}{{Continued on next page}} \\ \hline
  \endfoot
  
  \hline \hline
  \endlastfoot

  giregion & frequency \\
  McLaren Vale & 1195 \\
  Barossa Valley & 584 \\
  Murray Darling & 521 \\
  Riverland & 472 \\
  Adelaide Hills & 454 \\
  Langhorne Creek & 347 \\
  Margaret River & 344 \\
  Coonawarra & 284 \\
  Padthaway & 202 \\
  Wrattonbully & 195 \\
  Clare Valley & 149 \\
  Yarra Valley & 122 \\
  Eden Valley & 92 \\
  Tasmania & 89 \\
  Swan Hill & 83 \\
  Grampians & 73 \\
  Orange & 72 \\
  Hunter Valley & 70 \\
  Bendigo & 53 \\
  Great Southern & 51 \\
  Rutherglen & 41 \\
  Robe & 36 \\
  Tumbarumba & 35 \\
  Mornington Peninsula & 32 \\
  King Valley & 32 \\
  Southern Fleurieu & 30 \\
  Heathcote & 29 \\
  Adelaide Plains & 25 \\
  Currency Creek & 24 \\
   & 23 \\
  Henty & 22 \\
  Canberra District & 21 \\
  Southern Flinders Ranges & 20 \\
  Upper Goulburn & 20 \\
  Mudgee & 20 \\
  Mount Benson & 20 \\
  Other & 19 \\
  Riverina & 18 \\
  Alpine Valleys & 15 \\
  Barossa Zone & 14 \\
  Pemberton & 12 \\
  Mount Gambier & 11 \\
  Blackwood Valley & 10 \\
  Kangaroo Island & 10 \\
  Big Rivers Zone Other & 9 \\
  Geographe & 7 \\
  Cowra & 6 \\
  Gundagai & 5 \\
  Strathbogie Ranges & 5 \\
  Glenrowan & 4 \\
  Geelong & 4 \\
  Swan District & 4 \\
  Goulburn Valley & 3 \\
  Beechworth & 3 \\
  Southern Highlands & 3 \\
  Macedon Ranges & 2 \\
  Pyrenees & 2 \\
  Sunbury & 1 \\ \bottomrule
\end{longtable}
\end{center}
\clearpage

\section{XGBoost}
Following Chen and Guestrin \citep{chenXGBoostScalableTree2016}, XGBoost predicted a value $y_i$ from the input $x_i$. The method of prediction is achieved through a tree ensemble model, using $K$ additive functions to predict the output. Each of $f_k$ functions is a classification or regression tree, such that all functions are in the set of all decision trees, given by $\mathcal{F}$, is defined by ${f(x) = \omega_{q(x)}}(q : \mathbb{R}^m \rightarrow T, \omega \in \mathbb{R}^T)$. Where each function corresponds to an independent tree structure $q$ of $\omega$ weights. Each tree has $T$ leaves, which contain a continuous score, represented by $\omega_i$ for the i-th leaf. The final prediction is determined by the sum of the score of the corresponding leaves, given by:
\begin{equation}
 \hat{y_i}=\phi(x_i)=\sum_{k=1}^{K}{f_{k}(x_{i})}, \space f_{K}\in \mathcal{F},
\end{equation}

The set of functions, $\mathcal{F}$, used by the tree is determined by minimising a regularised objective function, $\mathcal{L}$ given by:

\begin{equation}\label{eqn:objective}
 \mathcal{L}(\phi)=\sum_i l(\hat{y_i}, y_i^{t-1} + f_t(x_i)) + \sum_k \Omega (f_K).
\end{equation}, where
\begin{equation}
  \Omega(f) = \gamma T + {{1}\over{2}}\lambda ||\omega||^2
\end{equation}

As predictions are made using additive tree functions, XGboost can be used for classification or regression. The difference between a prediction, $\phi(x_i)$, and actual variable, $f_{k}(x_i)$, is a differentiable convex loss function $l$. These properties of $l$ allow the function to be versatile in which objective we choose to optimise for, which is also important in being able to process both continuous and categorical variables. To optimise $l$, the difference is calculated for the i-th instance at the t-th iteration.
\subsection{Loss functions}

The functions included as parameters in equation \ref{eqn:objective} mean that traditional opimisation methods for Euclidean space cannot be used. Chen and Guestrin \citep{chenXGBoostScalableTree2016} illustrate, using Taylor expansions, that for a fixed structure $q(x)$ the optimal weight $\omega^*_j$ for a leaf $j$ can be derived. Importantly a loss function can be used to fit a model iteratively to data. For this analysis several loss functions were used, as variables took the form of continuous, binary and multi-call data. The loss function for making a split within the tree structure is given by:

\begin{equation} \label{eqn:enumerate}
\mathcal{L}_{split} = {{1}\over{2}} \left[ 
 {{(\sum_{i\in I_L}g_i)^{2}}\over{\sum_{i\in I_L} h_i + \lambda}} +
 {{(\sum_{i\in I_R}g_i)^{2}}\over{\sum_{i\in I_R} h_i + \lambda}} -
 {{(\sum_{i\in I}{g_i})^{2}}\over{\sum_{i \in I} h_i + \lambda}} \right] - \gamma.
\end{equation}

The tree structure being defined using left $I_L$ and right $I_R$ instance sets of nodes, with $I = I_L \cup I_R$. Instead of enumerating all possible tree structures, a greedy algorithm iteratively adds branches to the tree minimising $ \mathcal{L}_{split} $ in (\ref{eqn:enumerate}). The frequency of a variable's occurrence within a tree is directly attributed to the minimisation of the loss function through the minimisation of $ \mathcal{L}_{split} $.
\par
The loss functions used for this analysis were the root-mean-square function for continuous variables, the logistic loss function for binary class variables, and the soft max function for Multiclass variables. All objective functions are defined within the SKlearn library \citep{sklearn_api}, which was utilised via an API to the XGBoost library \citep{chenXGBoostScalableTree2016}.
\par
\subsection{Year}

 The classification tree and XGBoost performed similarly for classifying year with 35.20\% (6.28\% standard deviation) and 51.81\% (42.20\% validation accuracy) respectively. Electricity and the type of irrigation were highly influential within the classification tree. Similarly, electricity was the most frequently occurring node in the XGBoost ensemble. Other variables such as slashing passes, and fungicide and herbicide spraying were more prevalent than in the classification tree. Weed and disease outbreaks are likely an influential factor when classifying different years, making the decisions to spray and slash unique factors that differ year to year. Climatic differences between years are likely tied to the influence of yield and water use.
 \par
 Over half of the interrelated importance of the predictor variables is dominated by area harvested, yield and slashing passes. Although all the predictor variables are highly connected, their relative importance is not as prominent as the three major variables. It is of particular note of the relative importance of slashing passes to area, fuel and yield; as these are not directly related activities. The connection between the number of slashing and spraying passes is that those who do a set number of spraying or slashing passes tended to do that many passes for all slashing and spraying activities.
 
 \begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{year.pdf}}
  \caption{Decision tree predicting Year. Each node indicates the class predicted, and the proportion of elements agreeing with nodes partitioning, with the left direction indicating a yes to the nodes rule.}\label{fig:year_tree}
 \end{figure}
 
\begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{year.png}}
  \caption{The left-hand side depicts the 10 most relative important variables in predicting Year using XGBoost as a measure of node occurrence, using a Sankey diagram. The right-hand side depicts the interrelated importance of the ten predictor variables using a chord diagram.}\label{fig:year_sankey}
 \end{figure}

\subsection{Profit}

 \begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{profit.pdf}}
  \caption{Decision tree predicting revenue. Each node indicates the class predicted, and the proportion of elements agreeing with nodes partitioning, with the left direction indicating a yes to the nodes rule.}\label{fig:revenue_tree}
 \end{figure}
 
\begin{figure}[htb]
  \resizebox{\textwidth}{!}{
  \includegraphics{profit.png}}
  \caption{The left-hand side depicts the 10 most relative important variables in predicting revenue using XGBoost as a measure of node occurrence, using a Sankey diagram. The right-hand side depicts the interrelated importance of the ten predictor variables using a chord diagram.}\label{fig:profit}
 \end{figure}

Predictions of profit performed poorly compared to operating cost and profit with an average $R^2$ of 0.2535 and standard deviation of 0.3126. With the large standard deviation being indicative of how unstable the models created were.

\end{linenumbers}
 \end{document}
 
\endinput
